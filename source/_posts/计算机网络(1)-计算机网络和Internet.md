---
title: 计算机网络(1)-计算机网络和Internet
date: 2021-11-29 20:51:24
tags: 计算机网络
---



目标：

- 了解基本术语与概念
- 掌握网络的基本原理

<!-- more -->  

## 什么是Internet

- 网：是节点与边组成，与大小、形状无关的拓扑

- 计算机网络：

  - 路由器----网络层

    交换机----链路层 ：传输数据=带宽(bps)

  - 节点：

    - 设备：
      - 数据交换节点
      - 数据节点
    - 应用程序：主机及其运行的应用程序
  - 边：链路

    - 接入网链路：主机连接到互联网的链路
    - 主干链路：路由器间的链路

  - 协议：对等层实体在通信过程中应该遵守的规则和集合

    定义了报文格式和次序，以及在报文传输或接收或其他事件方面所采取的动作

    PDU(协议数据单元)：Protocol Data Unit

    **规范了语法、语义、时序和动作**

- 作用：

  - 为分布式的应用进程提供基础设施，是网络存在的理由

    无连接和面向连接的服务---(UDP/TCP)

  - 使用通信设施进行通信的分布式应用

## 网络结构

- 网络结构：核心通过接入网将任意的网络边缘连接，实现端端互联
  - 网络边缘：
    - 主机
    - 应用程序（客户端和服务器）
  - 网络核心：**数据交换**
    - 互联着的路由器
    - 网络中的网络
  - 接入网、物理媒体：**将边缘接入到网络核心**
    - 有线或无线通信链路

### 网络边缘

- 按模式划分为-端系统(主机):网络应用程序的设备
  - 客户/服务模式(C/S):
    可扩展性差，当到达一定程度后会出现断崖式下降
  - 对等模式(peer-peer):

    分布式，文件分发系统使用。既是客户端又是服务器，但服务器的扩容不能满足需求

- 采用网络设施的面向连接服务--端系统维持，网络核心不了解

  - 目标：在端系统之间传输数据
  - 方式----握手：在数据传输之前做好准备
  - 传输控制协议----**TCP**

    - 可靠地、按顺序地传送数据：**确认和重传**
    - 流量控制：发送方不会淹没接收方
    - 拥塞控制：当网络拥塞时，发送方降低发送速率

      [可靠性]:# "不重不漏不错不乱"
- 采用基础设施的无连接服务
  - 目标在端系统之间传输数据
  - UDP
    - 无连接
  - 不可靠
  - 无流量控制
  - 无拥塞控制

### 网络核心---路由器的网状网络

- 电路交换(线路交换)：

   为每个呼叫预留一条专有电路；端到端的资源被分配给从源端到目标端的呼叫‘call’ 计算机之间的通信有突发性，如过使用线路交换，则浪费的片较多即使这个呼叫没有数据传递，这个片也不能够被别的呼叫使用。

  - 信令系统
  - 独享资源：一旦建立起来就能够保证性能
  - 如果呼叫没有数据发送，被分配的资源就会被浪费
  - 传统电话网络采用
  - 特点：
    - 链路带宽、交换能力
    - 专用资源：不共享
    - 保证性能
    - 要求建立呼叫连接

  - 网络资源(如带宽)被分成片

    不适合计算机之间的通信

    - 为呼叫分配片
    - 如果某个呼叫没有数据，则其资源片处于空闲状态
    - 将带宽分成片：
      1. 频分-FDM
      2. 时分-TDM

- 分组交换：**存储转发**

  发送和接收时一个事物的两个方面(发送和接收时同时的)，传输延时只能算一遍----是一个**过程**

  以分组为单位存储-转发方式；是突发数据的胜利者

  1. 网络带宽资源不再分分一个个片，传输时使用全部带宽；资源共享，按需使用(packet)
  2. 将要传送的数据分成一个个单位：分组；将分组从一个路由器传到相邻路由器(hop--跳),一段段最终从源端到目标端。
     - 在转发之前，节点必须收到整个分组
     - 延迟比线路交换大
     - 排队时间
  3. 每段：采用链路的最大传输能力(带宽)
  4. 时分复用--特殊   统计多路复用
  5. 优缺点：
     - 适用于突发式数据传输
       - 简单，不必呼叫
       - 资源共享
     - 过度使用会造成网络拥塞，分组延时和丢失
       - 对可靠地数据传输需要协议来约束：拥塞控制

  - 排队和延迟：共享性的代价

    1. 如果到达速率>链路的输出速率：
       - 分组将会排队，等待传输
       - 如果路由器的缓存用完了，分组将会被抛弃

  - 网络核心的关键功能：

    - 路由(**全局选择**)：查路由表决定分组采用的源到目标的路径-------**路由算法**
    - 转发(**局部执行**)：将分组从路由器的输入链路转移到输出链路

  - 分组交换允许跟多用户使用网络：假设

    - 1Mb/s

    - 每个用户活动时100kb/s，10%的时间时活动的

      - 35用户时，>=10个用户活动的概率为0.0004

        ![计算公式](n重伯努利模型.png)

      - 当大于等于10时，路由器没有裕量。所以为9，这样当暂时发生分组排队时，在后来也能及时将数据发出

  - 种类：

    1. 数据报网络(datagram)：Internet
       - 在通信之前，无须建立其一个连接，有数据就传输
       - 每一个分组都是独立路由(路径不一样，可能会失序)
       - 路由器根据分组的目标地址进行路由
    2. 虚电路网络(virtual circuit)：X.25和ATM
       - 信令

- **时延** --主机传完不代表客户端能够立马接收到，时间和距离的延迟

  1. 传输时延
  2. 传播时延
  3. 处理时延

### 接入网和物理媒体

- 接入方式：

  - 住宅接入网络(Modem):调制解调器
  1. 调制解调器:
      1. 利用电话线，能保证的带宽只有4kHz;
      2. 通过Modem调制解调可以在56kHz范围内使用，且不能与电话同时进行
      3. DSL使用4kHz以上的带宽进行上网，不影响电话，
      4. 上行1M；下行10M传输速度
  2. 有线电视信号线缆双向改造。(FDM/共享)
      1. 非对称：最高30Mbps的下行，2Mbps的上行
      2. 线缆和光纤网络将全家庭用户接入到**ISP**路由器
      3. 各用户共享到线缆头端的接入网络
          - 与DSL不同，DSL每个用户一个专用线路到CO

      [ISP]:# "互联网服务提供商（Internet Service Provider），简称ISP，指的是面向公众提供下列信息服务的经营者：一是接入服务，即帮助用户接入Internet；二是导航服务，即帮助用户在Internet上找到所需要的信息；三是信息服务，即建立数据服务系统，收集、加工、存储信息，定期维护更新，并通过网络向用户提供信息内容服务"

  - 单位接入网络
    - 通过交换机的级联

  - 无线接入网络

    - 无线LANs:
    - 广域无线接入

- 物理媒
  - bit：在传输-接收对间传播
  - 物理介质：在每个传输-接收对，跨越一种物理媒体
  - 导引型：稳定，传的更远。沿着固体媒介
    - 双绞线(TP)
    - 同轴电缆
    - 光缆：多模/单模
  - 非导引型：不稳定，易衰减。信号自由传播。双向
    - 效应：**反射、吸收、干扰**
    - 地面微波
    - LAN
    - wide area 蜂窝
    - 卫星

## Internet结构和ISP

1. 端系统通过接入ISPs连接到互联网
2. 接入ISPs相应的必须是互联的--因此任何2个端系统可相互发送分组到对方

- 将每两个ISPs直接相连不可扩展需要O(N)连接
- 将每个接入ISP都连接到全局ISP，造成了竞争与合作
- 业务：全球与局域
- Internet结构：

  1. 松散的层次模型
  2. 中心：第一层ISP国家/国际覆盖，速率极高
      - 直接与其他第一层ISP相连
      - 与大量的第二层ISP和其他客户网络相连
  3. 第二层ISP：更小些的ISP

      - 与一个或多个第一层ISPs，也可能与其他第二层ISP
      - 通过合作覆盖更大的范围
  4. 一个分组要经过许多网络

- ISP之间的连接

  - POP：高层ISP面向客户网络的接入点，涉及费用结算
  - 对等接入：2个ISP对等互接，不涉及费用结算
  - IXP：多个对等ISP互联互通之处
  - ICP自己部署专用网络，同时和各级ISP连接

## 分组延时、丢失和吞吐量

- 造成分组丢失和延时的原因：

  - 分组到达链路的速率超过了链路输出的能力
  - 分组等待排到对头、被传输

- 四种分组延时：

  1. 节点处理延时

     - 检查bit级差错
     - 检查分组首部和决定将分组导向何处
  2. 排队延时

     - 在输出链路上等待传输的时间
     - 依赖于路由器的拥塞程度
     - 取决于流量强度I

        - a = 分组到达队列的平均速率
        - 流量强度 = La/R
        - La/R ~ 0: 平均排队时延很小
        - La/R -> 1: 延时变得很大
        - La/R >= 1: 比特到达队列的速率超过了从该队列输出的速率，平均排队延时将趋向无穷大,会丢包
      **注意:设计系统时流量强度不能大于1**
        - TTL(Time to live):生存时间，过一个路由器减一，为0返回原主机。在ICMP协议规定。
  3. 传输延时

     - R = 链路带宽(bps)
     - L = 分组长度(bits)
     - 将分组发送到链路上的时间 = L/R
     - 存储转发延时
  4. 传播延时

     - d = 物理链路的长度
     - s = 在媒体上的传播速度(~$ 2 \times 10^8 m/sec$)
     - 传播时延 = d/s
  5. 节点延时：

     - 节点延时计算:
      $d_{nodal}  = d_{proc} + d_{queue} + d_{trans} + d_{prop}$
      $$
        \begin{align}
        &d_{proc} = 处理延时  \qquad  通常是微秒数量级或更少
        \\
        &d_{queue} = 排队延时  \qquad 取决于拥塞程度
        \\
        &d_{trans} = 传输延时=L/R，对低速率的链路而言很大(如拨号)，通常为微秒级到毫秒级
        \\
        &d_{prop} = 传播时延 \qquad 几微秒到几百毫秒\\
        \end{align}
      $$
- 分组丢失：

  - 链路的队列缓冲区容量有限

  - 当分组到达一个满的队列时，该分组将会丢失

  - 丢失的分组可能会被前一个节点或源端系统重传，或根本不重传

- 吞吐量：

  - 在源端和目标端之间传输的速率(数据量/单位时间)

    - 瞬间吞吐量：一个时间点的速率
    - 平均吞吐量：一个长时间内的平均值
    - 瓶颈链路：端到端路径上，限制端到端吞吐的链路

## 协议层次及服务模型

- 协议层次：

  - 网络是一个复杂的系统：**模块化**
    1. 网络功能繁杂
    2. 构成元素多
    3. 使用分层的方式来解决复杂的网络设计与实现
       - 将网络功能分层，**功能**明确，**层次**清晰，可以给上层提供**服务**

       - 本层协议实体相互执行交互执行本层的**协议动作**，目的时实现本层功能，通过接口为上层提供服务
       - 在实现本层本层的协议的时候，直接利用了下层所提供的服务

  - 服务与服务访问点

    - 服务(Service)：低层实体想上层实体提供它们之间的通信能力

      - 服务用户
      - 服务提供者

    - 原语(primitive)：上层使用下层服务的形式，高层使用低层提供的服务，以及低层向高层提供服务都是通过服务访问原语来进行交互--**形式(API)**

    - 服务访问点SAP(Services Access Point)：上层使用下层提供的服务通过层间的接口--地点

      - 例子：邮箱
      - 地址(ip address):下层的一个实体支撑着上层的多个实体，SAP有标志不同上层实体的作用
      - 可以有不同的实现，队列
      - 例子：传输层的SAP：端口(port)

    - 服务的类型

      - 面向连接的服务和无连接的服务-方式

        - 面向连接的服务

          1. 连接(connection): 两个同信实体为进行通信而建立的一种结合
          2. 通信过程：建立连接，通信，拆除连接
          3. 例子：网络层的连接被称为虚电路
          4. 适用范围：对于大的数据块要传输；不适合小的零星报文
          5. 特点：保序
          6. 服务类型：

              - 可靠的信息流 -- 传送页面(可靠的获得，通过接收方的确认)
              - 可靠的字节流 -- 远程登陆
              - 不可靠的连接 -- 数字化声音

        - 无连接的服务：

          1. 无连接的服务：两个对等层实体在通信前不需要建立一个连接，不预留资源；不需要通信双方都是活跃(如寄信)
          2. 特点：不可靠、可能重复、可能失序
          3. IP分组，数据包
          4. 使用范围：适合传送零星数据
          5. 服务类型：

              - 不可靠的数据报 -- 电子方式的函件
              - 有确认的数据报 -- 挂号信
              - 请求回答 -- 信息查询
    - 服务和协议

      - 区别：

        - 服务(Service)：低层实体向上层实体提供它们之间的通信的能力，是通过原语(Primitive)来操作的，垂直。
        - 协议(Protocal):对等层实体(peer entity)之间在相互通信的过程中，需要遵循的规则的集合，水平。

      - 联系

        - 本层**协议的实现**要靠下层提供的服务来实现
        - 本层实体通过协议为上层提供**更高级的服务**
  
  - 数据单元(DU)

    ![数据单元](数据单元.png)

    - 各层次的协议数据单元(PDU):

      1. 应用层：报文(message)
      2. 传输层：报文段(segment) -- TCP段，UDP数据报
      3. 网络层：分组packet(如果无连接方式：数据报datagram)
      4. 数据链路层：帧(frame)
      5. 物理层：位(bit)
  - 分层处理和实现复杂系统

    - 概念化：结构清晰，便于标识网络组件，以及描述其相互关系
    - 结构化：模块化更易于维护和系统升级

      - 改变某一层服务的实现不影响系统中的其他层次

        - 对于其他层次而言是透明的

    - 效率变低
  - Internet协议栈--数据的封装与解封装过程
  
    - 应用层：网络应用

      - 为人类用户或者其他应用进程提供网络应用服务
      - FTP，SMTP，HTTP，DNS
    - 传输层：主机之间的数据传输

      - 在网络层提供的端到端通信基础上，细分为进程到进程，将不可靠的通信变成可靠地通信
      - TCP,UDP
    - 网络层：为数据报从源目的选择路由

      - 主机主机之间的通信，端到端通信，不可靠
      - IP，路由协议
    - 链路层：相连网络节点之间的数据传输

      - 2个相邻2点的通信，点到点通信，可靠或不可靠
      - 点对点协议PPP，802.11(wifi),Ethernet
    - 物理层：在线路上传送bit
  - ISO/OSI参考模型 -- 在上述协议栈的应用层和传输层多了两层

    - 表示层：允许应用解释传输的数据，e.g.,加密，压缩，机器相关的表示转换
    - 会话层：数据交换的同步，检查点，恢复。
    - 在协议栈中是应用层中去处理
